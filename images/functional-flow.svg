<svg width="800" height="600" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#2563eb" />
    </marker>
  </defs>

  <!-- Title -->
  <text x="400" y="30" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#1e293b" text-anchor="middle">
    RAG System Functional Flow
  </text>

  <!-- Input Sources -->
  <g id="input-sources">
    <rect x="50" y="80" width="120" height="80" rx="8" fill="#dbeafe" stroke="#2563eb" stroke-width="2"/>
    <text x="110" y="105" font-family="Arial" font-size="12" font-weight="bold" fill="#1e40af" text-anchor="middle">Input Sources</text>
    <text x="110" y="125" font-family="Arial" font-size="10" fill="#1e40af" text-anchor="middle">• Documents</text>
    <text x="110" y="140" font-family="Arial" font-size="10" fill="#1e40af" text-anchor="middle">• PDFs/Images</text>
    <text x="110" y="155" font-family="Arial" font-size="10" fill="#1e40af" text-anchor="middle">• Audio/Video</text>
  </g>

  <!-- Document Processing -->
  <g id="processing">
    <rect x="230" y="80" width="140" height="80" rx="8" fill="#fef3c7" stroke="#f59e0b" stroke-width="2"/>
    <text x="300" y="105" font-family="Arial" font-size="12" font-weight="bold" fill="#92400e" text-anchor="middle">Processing</text>
    <text x="300" y="125" font-family="Arial" font-size="10" fill="#92400e" text-anchor="middle">• Chunking</text>
    <text x="300" y="140" font-family="Arial" font-size="10" fill="#92400e" text-anchor="middle">• Entity Extraction</text>
    <text x="300" y="155" font-family="Arial" font-size="10" fill="#92400e" text-anchor="middle">• Embeddings</text>
  </g>

  <!-- Storage Layer -->
  <g id="storage">
    <rect x="430" y="50" width="140" height="50" rx="8" fill="#dcfce7" stroke="#16a34a" stroke-width="2"/>
    <text x="500" y="70" font-family="Arial" font-size="11" font-weight="bold" fill="#166534" text-anchor="middle">Vector DB</text>
    <text x="500" y="85" font-family="Arial" font-size="9" fill="#166534" text-anchor="middle">(Weaviate)</text>

    <rect x="430" y="120" width="140" height="50" rx="8" fill="#e0e7ff" stroke="#6366f1" stroke-width="2"/>
    <text x="500" y="140" font-family="Arial" font-size="11" font-weight="bold" fill="#4338ca" text-anchor="middle">Graph DB</text>
    <text x="500" y="155" font-family="Arial" font-size="9" fill="#4338ca" text-anchor="middle">(Neo4j)</text>
  </g>

  <!-- Query Input -->
  <g id="query-input">
    <rect x="50" y="260" width="120" height="60" rx="8" fill="#fce7f3" stroke="#ec4899" stroke-width="2"/>
    <text x="110" y="280" font-family="Arial" font-size="12" font-weight="bold" fill="#9f1239" text-anchor="middle">User Query</text>
    <text x="110" y="300" font-family="Arial" font-size="10" fill="#9f1239" text-anchor="middle">Natural Language</text>
  </g>

  <!-- Retrieval Strategies -->
  <g id="retrieval">
    <rect x="230" y="240" width="140" height="100" rx="8" fill="#f3e8ff" stroke="#a855f7" stroke-width="2"/>
    <text x="300" y="260" font-family="Arial" font-size="12" font-weight="bold" fill="#6b21a8" text-anchor="middle">Retrieval</text>
    <text x="300" y="280" font-family="Arial" font-size="9" fill="#6b21a8" text-anchor="middle">• Vector Search</text>
    <text x="300" y="295" font-family="Arial" font-size="9" fill="#6b21a8" text-anchor="middle">• Graph Traversal</text>
    <text x="300" y="310" font-family="Arial" font-size="9" fill="#6b21a8" text-anchor="middle">• Hybrid (RRF)</text>
    <text x="300" y="325" font-family="Arial" font-size="9" fill="#6b21a8" text-anchor="middle">• HyDE / Decomp</text>
  </g>

  <!-- LLM Processing -->
  <g id="llm">
    <rect x="430" y="260" width="140" height="60" rx="8" fill="#fef2f2" stroke="#ef4444" stroke-width="2"/>
    <text x="500" y="280" font-family="Arial" font-size="12" font-weight="bold" fill="#991b1b" text-anchor="middle">LLM Generation</text>
    <text x="500" y="300" font-family="Arial" font-size="10" fill="#991b1b" text-anchor="middle">GPT-4 / ProxyLLM</text>
  </g>

  <!-- Response -->
  <g id="response">
    <rect x="630" y="260" width="120" height="60" rx="8" fill="#d1fae5" stroke="#10b981" stroke-width="2"/>
    <text x="690" y="280" font-family="Arial" font-size="12" font-weight="bold" fill="#065f46" text-anchor="middle">Response</text>
    <text x="690" y="300" font-family="Arial" font-size="10" fill="#065f46" text-anchor="middle">+ Sources</text>
  </g>

  <!-- Quality & Monitoring -->
  <g id="monitoring">
    <rect x="230" y="390" width="340" height="80" rx="8" fill="#fef9c3" stroke="#eab308" stroke-width="2"/>
    <text x="400" y="415" font-family="Arial" font-size="12" font-weight="bold" fill="#713f12" text-anchor="middle">Quality &amp; Monitoring</text>
    <text x="400" y="435" font-family="Arial" font-size="10" fill="#713f12" text-anchor="middle">• Relevance Evaluation • Cost Tracking • Quality Metrics</text>
    <text x="400" y="455" font-family="Arial" font-size="10" fill="#713f12" text-anchor="middle">• Prometheus Metrics • Grafana Dashboards • User Feedback</text>
  </g>

  <!-- Use Cases -->
  <g id="use-cases">
    <rect x="50" y="510" width="700" height="70" rx="8" fill="#f0f9ff" stroke="#0284c7" stroke-width="2"/>
    <text x="400" y="535" font-family="Arial" font-size="13" font-weight="bold" fill="#0c4a6e" text-anchor="middle">Enterprise Use Cases</text>
    <text x="400" y="555" font-family="Arial" font-size="10" fill="#0c4a6e" text-anchor="middle">Customer Support • Knowledge Management • Code Assistant • Research &amp; Analysis • Compliance Queries</text>
  </g>

  <!-- Arrows - Ingestion Flow -->
  <line x1="170" y1="120" x2="230" y2="120" stroke="#2563eb" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="370" y1="75" x2="430" y2="75" stroke="#2563eb" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="370" y1="145" x2="430" y2="145" stroke="#2563eb" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- Arrows - Query Flow -->
  <line x1="170" y1="290" x2="230" y2="290" stroke="#ec4899" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="370" y1="290" x2="430" y2="290" stroke="#ec4899" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="570" y1="290" x2="630" y2="290" stroke="#ec4899" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- Arrows - Storage to Retrieval -->
  <line x1="500" y1="100" x2="330" y2="240" stroke="#6b21a8" stroke-width="1.5" stroke-dasharray="4" opacity="0.6"/>
  <line x1="500" y1="170" x2="330" y2="240" stroke="#6b21a8" stroke-width="1.5" stroke-dasharray="4" opacity="0.6"/>

  <!-- Arrow - Monitoring -->
  <line x1="500" y1="320" x2="400" y2="390" stroke="#eab308" stroke-width="1.5" stroke-dasharray="4" opacity="0.6"/>

  <!-- Labels -->
  <text x="200" y="115" font-family="Arial" font-size="9" fill="#64748b">Ingest</text>
  <text x="400" y="65" font-family="Arial" font-size="9" fill="#64748b">Store</text>
  <text x="200" y="285" font-family="Arial" font-size="9" fill="#64748b">Search</text>
  <text x="400" y="285" font-family="Arial" font-size="9" fill="#64748b">Generate</text>
  <text x="600" y="285" font-family="Arial" font-size="9" fill="#64748b">Return</text>
</svg>
